{"logger":"webhook.discounts.updated","ts":"2025-09-12T18:16:56.439Z","message":"Received webhook","topic":"DISCOUNTS_UPDATE","shop":"discount-metafield-remix-akash-test.myshopify.com"}
{"logger":"webhook.discounts.updated","ts":"2025-09-12T18:16:57.099Z","message":"Updated existing metafield rule","discountId":"1276512239794"}
{"logger":"webhook.discounts.updated","ts":"2025-09-12T18:16:57.590Z","message":"Found discount node","discountId":"gid://shopify/DiscountAutomaticNode/1276512239794","typename":"DiscountAutomaticBasic","title":"12 per off","status":"ACTIVE"}
{"logger":"webhook.discounts.updated","ts":"2025-09-12T18:16:57.591Z","message":"Parsed discount targeting","discountId":"gid://shopify/DiscountAutomaticNode/1276512239794","appliesToAll":false,"productCount":0,"collectionCount":1}
{"logger":"webhook.discounts.updated","ts":"2025-09-12T18:16:58.102Z","message":"Fetched products from collections","collectionCount":1,"productCount":3}
{"logger":"webhook.discounts.updated","ts":"2025-09-12T18:16:58.102Z","message":"Found affected products","discountGraphqlId":"gid://shopify/DiscountAutomaticNode/1276512239794","count":3}
{"logger":"webhook.discounts.updated","ts":"2025-09-12T18:16:59.184Z","message":"Updated product metafield","productId":"gid://shopify/Product/8579006759090","discountId":"1276512239794","discountCount":3}
{"logger":"webhook.discounts.updated","ts":"2025-09-12T18:17:00.702Z","message":"Updated product metafield","productId":"gid://shopify/Product/8579006628018","discountId":"1276512239794","discountCount":5}
{"logger":"webhook.discounts.updated","ts":"2025-09-12T18:17:02.159Z","message":"Updated product metafield","productId":"gid://shopify/Product/8579006464178","discountId":"1276512239794","discountCount":2}
{"logger":"webhook.discounts.updated","ts":"2025-09-12T18:17:02.663Z","message":"Bulk metafield update completed","totalProcessed":3,"successCount":3,"failureCount":0,"discountId":"1276512239794"}
{"logger":"webhook.discounts.updated","ts":"2025-09-12T18:17:02.672Z","message":"Updated product metafields","updated":3,"attempted":3,"discountId":"1276512239794"}
{"logger":"webhook.discounts.updated","ts":"2025-09-12T18:17:02.673Z","message":"Processed discount update","id":"1276512239794","title":"12 per off","type":"automatic","status":"ACTIVE","value":"12%","shop":"discount-metafield-remix-akash-test.myshopify.com"}
{"logger":"webhook.discounts.updated","ts":"2025-09-12T18:17:13.766Z","message":"Received webhook","topic":"DISCOUNTS_UPDATE","shop":"discount-metafield-remix-akash-test.myshopify.com"}
{"logger":"webhook.discounts.updated","ts":"2025-09-12T18:17:14.442Z","message":"Updated existing metafield rule","discountId":"1276512239794"}
{"logger":"webhook.discounts.updated","ts":"2025-09-12T18:17:14.916Z","message":"Found discount node","discountId":"gid://shopify/DiscountAutomaticNode/1276512239794","typename":"DiscountAutomaticBasic","title":"12 per off","status":"ACTIVE"}
{"logger":"webhook.discounts.updated","ts":"2025-09-12T18:17:14.916Z","message":"Parsed discount targeting","discountId":"gid://shopify/DiscountAutomaticNode/1276512239794","appliesToAll":false,"productCount":0,"collectionCount":1}
{"logger":"webhook.discounts.updated","ts":"2025-09-12T18:17:15.404Z","message":"Fetched products from collections","collectionCount":1,"productCount":3}
{"logger":"webhook.discounts.updated","ts":"2025-09-12T18:17:15.404Z","message":"Found affected products","discountGraphqlId":"gid://shopify/DiscountAutomaticNode/1276512239794","count":3}
{"logger":"webhook.discounts.updated","ts":"2025-09-12T18:17:16.335Z","message":"Updated product metafield","productId":"gid://shopify/Product/8579006759090","discountId":"1276512239794","discountCount":3}
{"logger":"webhook.discounts.updated","ts":"2025-09-12T18:17:17.909Z","message":"Updated product metafield","productId":"gid://shopify/Product/8579006628018","discountId":"1276512239794","discountCount":5}
{"logger":"webhook.discounts.updated","ts":"2025-09-12T18:17:19.438Z","message":"Updated product metafield","productId":"gid://shopify/Product/8579006464178","discountId":"1276512239794","discountCount":2}
{"logger":"webhook.discounts.updated","ts":"2025-09-12T18:17:19.939Z","message":"Bulk metafield update completed","totalProcessed":3,"successCount":3,"failureCount":0,"discountId":"1276512239794"}
{"logger":"webhook.discounts.updated","ts":"2025-09-12T18:17:19.948Z","message":"Updated product metafields","updated":3,"attempted":3,"discountId":"1276512239794"}
{"logger":"webhook.discounts.updated","ts":"2025-09-12T18:17:19.948Z","message":"Processed discount update","id":"1276512239794","title":"12 per off","type":"automatic","status":"ACTIVE","value":"12%","shop":"discount-metafield-remix-akash-test.myshopify.com"}
{"logger":"webhook.discounts.deleted","ts":"2025-09-12T18:19:06.872Z","message":"Received webhook","topic":"DISCOUNTS_DELETE","shop":"discount-metafield-remix-akash-test.myshopify.com"}
{"logger":"webhook.discounts.deleted","ts":"2025-09-12T18:19:06.884Z","message":"Deactivated metafield rule for deleted discount","discountId":"1276562833586"}
{"logger":"webhook.discounts.deleted","ts":"2025-09-12T18:19:09.295Z","message":"Discount not found with any node type","discountId":"1276562833586","candidates":["gid://shopify/DiscountAutomaticNode/1276562833586","gid://shopify/DiscountCodeNode/1276562833586","gid://shopify/DiscountNode/1276562833586"]}
{"logger":"webhook.discounts.deleted","ts":"2025-09-12T18:19:09.295Z","message":"No targeting found for discount","discountId":"1276562833586"}
{"logger":"webhook.discounts.deleted","ts":"2025-09-12T18:19:19.569Z","message":"Bulk discount removal completed","totalProcessed":10,"successCount":10,"failureCount":0,"discountId":"1276562833586"}
{"logger":"webhook.discounts.deleted","ts":"2025-09-12T18:19:19.569Z","message":"Removed discount from products","removed":10,"attempted":10,"discountId":"1276562833586"}
{"logger":"webhook.discounts.deleted","ts":"2025-09-12T18:19:19.569Z","message":"Processed discount deletion","id":"1276562833586","deleted":true,"shop":"discount-metafield-remix-akash-test.myshopify.com"}
{"logger":"webhook.discounts.updated","ts":"2025-09-12T18:21:51.666Z","message":"Received webhook","topic":"DISCOUNTS_UPDATE","shop":"discount-metafield-remix-akash-test.myshopify.com"}
{"logger":"webhook.discounts.updated","ts":"2025-09-12T18:21:52.310Z","message":"Updated existing metafield rule","discountId":"1276512239794"}
{"logger":"webhook.discounts.updated","ts":"2025-09-12T18:21:52.852Z","message":"Found discount node","discountId":"gid://shopify/DiscountAutomaticNode/1276512239794","typename":"DiscountAutomaticBasic","title":"12 per off","status":"ACTIVE"}
{"logger":"webhook.discounts.updated","ts":"2025-09-12T18:21:52.853Z","message":"Parsed discount targeting","discountId":"gid://shopify/DiscountAutomaticNode/1276512239794","appliesToAll":false,"productCount":0,"collectionCount":1}
{"logger":"webhook.discounts.updated","ts":"2025-09-12T18:21:53.337Z","message":"Fetched products from collections","collectionCount":1,"productCount":3}
{"logger":"webhook.discounts.updated","ts":"2025-09-12T18:21:53.338Z","message":"Found affected products","discountGraphqlId":"gid://shopify/DiscountAutomaticNode/1276512239794","count":3}
{"logger":"webhook.discounts.updated","ts":"2025-09-12T18:21:54.380Z","message":"Updated product metafield","productId":"gid://shopify/Product/8579006759090","discountId":"1276512239794","discountCount":3}
{"logger":"webhook.discounts.updated","ts":"2025-09-12T18:21:56.654Z","message":"Updated product metafield","productId":"gid://shopify/Product/8579006628018","discountId":"1276512239794","discountCount":5}
{"logger":"webhook.discounts.updated","ts":"2025-09-12T18:21:58.118Z","message":"Updated product metafield","productId":"gid://shopify/Product/8579006464178","discountId":"1276512239794","discountCount":2}
{"logger":"webhook.discounts.updated","ts":"2025-09-12T18:21:58.633Z","message":"Bulk metafield update completed","totalProcessed":3,"successCount":3,"failureCount":0,"discountId":"1276512239794"}
{"logger":"webhook.discounts.updated","ts":"2025-09-12T18:21:58.647Z","message":"Updated product metafields","updated":3,"attempted":3,"discountId":"1276512239794"}
{"logger":"webhook.discounts.updated","ts":"2025-09-12T18:21:58.647Z","message":"Processed discount update","id":"1276512239794","title":"12 per off","type":"automatic","status":"ACTIVE","value":"12%","shop":"discount-metafield-remix-akash-test.myshopify.com"}
{"logger":"webhook.discounts.updated","ts":"2025-09-12T18:28:06.388Z","message":"Received webhook","topic":"DISCOUNTS_UPDATE","shop":"discount-metafield-remix-akash-test.myshopify.com"}
{"logger":"webhook.discounts.updated","ts":"2025-09-12T18:28:07.068Z","message":"Updated existing metafield rule","discountId":"1276512239794"}
{"logger":"webhook.discounts.updated","ts":"2025-09-12T18:28:07.569Z","message":"Found discount node","discountId":"gid://shopify/DiscountAutomaticNode/1276512239794","typename":"DiscountAutomaticBasic","title":"12 per off","status":"ACTIVE"}
{"logger":"webhook.discounts.updated","ts":"2025-09-12T18:28:07.570Z","message":"Parsed discount targeting","discountId":"gid://shopify/DiscountAutomaticNode/1276512239794","appliesToAll":false,"productCount":0,"collectionCount":1}
{"logger":"webhook.discounts.updated","ts":"2025-09-12T18:28:08.774Z","message":"Fetched products from collections","collectionCount":1,"productCount":3}
{"logger":"webhook.discounts.updated","ts":"2025-09-12T18:28:08.774Z","message":"Found affected products","discountGraphqlId":"gid://shopify/DiscountAutomaticNode/1276512239794","count":3}
{"logger":"webhook.discounts.updated","ts":"2025-09-12T18:28:09.725Z","message":"Updated product metafield","productId":"gid://shopify/Product/8579006759090","discountId":"1276512239794","discountCount":3}
{"logger":"webhook.discounts.updated","ts":"2025-09-12T18:28:11.181Z","message":"Updated product metafield","productId":"gid://shopify/Product/8579006628018","discountId":"1276512239794","discountCount":5}
{"logger":"webhook.discounts.updated","ts":"2025-09-12T18:28:12.716Z","message":"Updated product metafield","productId":"gid://shopify/Product/8579006464178","discountId":"1276512239794","discountCount":2}
{"logger":"webhook.discounts.updated","ts":"2025-09-12T18:28:13.224Z","message":"Bulk metafield update completed","totalProcessed":3,"successCount":3,"failureCount":0,"discountId":"1276512239794"}
{"logger":"webhook.discounts.updated","ts":"2025-09-12T18:28:13.241Z","message":"Updated product metafields","updated":3,"attempted":3,"discountId":"1276512239794"}
{"logger":"webhook.discounts.updated","ts":"2025-09-12T18:28:13.241Z","message":"Processed discount update","id":"1276512239794","title":"12 per off","type":"automatic","status":"ACTIVE","value":"12%","shop":"discount-metafield-remix-akash-test.myshopify.com"}
{"logger":"webhook.discounts.deleted","ts":"2025-09-12T18:41:15.331Z","message":"Received webhook","topic":"DISCOUNTS_DELETE","shop":"discount-metafield-remix-akash-test.myshopify.com"}
{"logger":"webhook.discounts.deleted","ts":"2025-09-12T18:41:15.334Z","message":"Webhook processing failed","error":"(0 , __vite_ssr_import_4__.createWebhookAdminClient) is not a function","code":"UNKNOWN_ERROR","statusCode":500,"context":{"scope":"webhook.discounts.deleted","topic":"DISCOUNTS_DELETE","shop":"discount-metafield-remix-akash-test.myshopify.com","payload":"{\"admin_graphql_api_id\":\"gid://shopify/DiscountAutomaticNode/1276562833586\",\"deleted_at\":null}","originalError":"(0 , __vite_ssr_import_4__.createWebhookAdminClient) is not a function"}}
{"logger":"webhook.discounts.deleted","ts":"2025-09-12T18:41:15.333Z","message":"(0 , __vite_ssr_import_4__.createWebhookAdminClient) is not a function","stack":"AppError: (0 , __vite_ssr_import_4__.createWebhookAdminClient) is not a function\n    at ErrorHandlingService.handleError (/home/akash/projects/shopify-apps/discount-remix-akash/app/services/error-handling.service.ts:86:18)\n    at action (/home/akash/projects/shopify-apps/discount-remix-akash/app/routes/webhooks.discounts.deleted.tsx:46:35)\n    at Object.callRouteAction (/home/akash/projects/shopify-apps/discount-remix-akash/node_modules/@remix-run/server-runtime/dist/data.js:36:16)\n    at /home/akash/projects/shopify-apps/discount-remix-akash/node_modules/@remix-run/router/router.ts:4934:19\n    at callLoaderOrAction (/home/akash/projects/shopify-apps/discount-remix-akash/node_modules/@remix-run/router/router.ts:4998:16)\n    at async Promise.all (index 0)\n    at defaultDataStrategy (/home/akash/projects/shopify-apps/discount-remix-akash/node_modules/@remix-run/router/router.ts:4807:17)\n    at callDataStrategyImpl (/home/akash/projects/shopify-apps/discount-remix-akash/node_modules/@remix-run/router/router.ts:4870:17)\n    at callDataStrategy (/home/akash/projects/shopify-apps/discount-remix-akash/node_modules/@remix-run/router/router.ts:4027:19)\n    at submit (/home/akash/projects/shopify-apps/discount-remix-akash/node_modules/@remix-run/router/router.ts:3790:21)\n    at queryImpl (/home/akash/projects/shopify-apps/discount-remix-akash/node_modules/@remix-run/router/router.ts:3719:22)\n    at Object.queryRoute (/home/akash/projects/shopify-apps/discount-remix-akash/node_modules/@remix-run/router/router.ts:3664:18)\n    at handleResourceRequest (/home/akash/projects/shopify-apps/discount-remix-akash/node_modules/@remix-run/server-runtime/dist/server.js:440:20)\n    at requestHandler (/home/akash/projects/shopify-apps/discount-remix-akash/node_modules/@remix-run/server-runtime/dist/server.js:166:18)\n    at nodeHandler (/home/akash/projects/shopify-apps/discount-remix-akash/node_modules/@remix-run/dev/dist/vite/plugin.js:859:27)\n    at /home/akash/projects/shopify-apps/discount-remix-akash/node_modules/@remix-run/dev/dist/vite/plugin.js:862:15","scope":"webhook.discounts.deleted","topic":"DISCOUNTS_DELETE","shop":"discount-metafield-remix-akash-test.myshopify.com","payload":"{\"admin_graphql_api_id\":\"gid://shopify/DiscountAutomaticNode/1276562833586\",\"deleted_at\":null}","errorCode":"UNKNOWN_ERROR","statusCode":500,"isOperational":false}
