{"logger":"webhook.discounts.created","ts":"2025-09-14T23:10:59.219Z","message":"Received webhook","topic":"DISCOUNTS_CREATE","shop":"discount-metafield-remix-akash-test.myshopify.com"}
{"logger":"webhook.discounts.created","ts":"2025-09-14T23:11:01.402Z","message":"Failed to fetch full discount details with candidates","candidates":["gid://shopify/DiscountAutomaticNode/1276832121010","gid://shopify/DiscountCodeNode/1276832121010","gid://shopify/DiscountNode/1276832121010"]}
{"logger":"webhook.discounts.created","ts":"2025-09-14T23:11:01.402Z","message":"Could not fetch full discount details, using webhook payload","discountId":"1276832121010"}
{"logger":"webhook.discounts.created","ts":"2025-09-14T23:11:01.419Z","message":"Updated existing metafield rule","discountId":"1276832121010"}
{"logger":"webhook.discounts.created","ts":"2025-09-14T23:11:02.882Z","message":"Discount not found with any node type","discountId":"gid://shopify/DiscountAutomaticNode/1276832121010","candidates":["gid://shopify/DiscountAutomaticNode/1276832121010","gid://shopify/DiscountCodeNode/1276832121010","gid://shopify/DiscountNode/1276832121010"]}
{"logger":"webhook.discounts.created","ts":"2025-09-14T23:11:02.882Z","message":"No targeting found for discount","discountId":"gid://shopify/DiscountAutomaticNode/1276832121010"}
{"logger":"webhook.discounts.created","ts":"2025-09-14T23:11:02.882Z","message":"Found affected products","discountGraphqlId":"gid://shopify/DiscountAutomaticNode/1276832121010","count":0}
{"logger":"webhook.discounts.created","ts":"2025-09-14T23:11:02.882Z","message":"Processed discount created","id":"1276832121010","title":"20per","type":"automatic","status":"ACTIVE","code":"N/A (Automatic)","value":"Unknown","deleted":false,"shop":"discount-metafield-remix-akash-test.myshopify.com"}
{"logger":"webhook.discounts.created","ts":"2025-09-14T23:11:10.265Z","message":"Received webhook","topic":"DISCOUNTS_CREATE","shop":"discount-metafield-remix-akash-test.myshopify.com"}
{"logger":"webhook.discounts.created","ts":"2025-09-14T23:11:10.902Z","message":"Created metafield rule","discountId":"1276832317618"}
{"logger":"webhook.discounts.created","ts":"2025-09-14T23:11:11.443Z","message":"Found discount node","discountId":"gid://shopify/DiscountAutomaticNode/1276832317618","typename":"DiscountAutomaticBasic","title":"20per","status":"ACTIVE"}
{"logger":"webhook.discounts.created","ts":"2025-09-14T23:11:11.443Z","message":"Parsed discount targeting","discountId":"gid://shopify/DiscountAutomaticNode/1276832317618","appliesToAll":false,"productCount":0,"collectionCount":1}
{"logger":"webhook.discounts.created","ts":"2025-09-14T23:11:11.923Z","message":"Fetched products from collections","collectionCount":1,"productCount":3}
{"logger":"webhook.discounts.created","ts":"2025-09-14T23:11:11.923Z","message":"Found affected products","discountGraphqlId":"gid://shopify/DiscountAutomaticNode/1276832317618","count":3}
{"logger":"webhook.discounts.created","ts":"2025-09-14T23:11:12.856Z","message":"Updated product metafield","productId":"gid://shopify/Product/8579006759090","discountId":"1276832317618","discountCount":3}
{"logger":"webhook.discounts.created","ts":"2025-09-14T23:11:14.312Z","message":"Updated product metafield","productId":"gid://shopify/Product/8579006628018","discountId":"1276832317618","discountCount":3}
{"logger":"webhook.products.updated","ts":"2025-09-14T23:11:14.658Z","message":"Received product webhook","topic":"PRODUCTS_UPDATE","shop":"discount-metafield-remix-akash-test.myshopify.com"}
{"logger":"webhook.products.updated","ts":"2025-09-14T23:11:14.658Z","message":"Processing product update webhook","productId":8579006759090,"shopifyId":"8579006759090","title":"The Collection Snowboard: Liquid"}
{"logger":"webhook.products.updated","ts":"2025-09-14T23:11:15.136Z","message":"Synced product from Shopify","shopifyId":"8579006759090","saved":true}
{"logger":"webhook.products.updated","ts":"2025-09-14T23:11:15.139Z","message":"Processed product updated","id":17,"title":"The Collection Snowboard: Liquid","shopifyId":"8579006759090","deleted":false,"shop":"discount-metafield-remix-akash-test.myshopify.com"}
{"logger":"webhook.products.updated","ts":"2025-09-14T23:11:15.139Z","message":"Product updated and synced successfully","shopifyId":"8579006759090","title":"The Collection Snowboard: Liquid","shop":"discount-metafield-remix-akash-test.myshopify.com"}
{"logger":"webhook.discounts.created","ts":"2025-09-14T23:11:15.911Z","message":"Updated product metafield","productId":"gid://shopify/Product/8579006464178","discountId":"1276832317618","discountCount":3}
{"logger":"webhook.discounts.created","ts":"2025-09-14T23:11:16.412Z","message":"Bulk metafield update completed","totalProcessed":3,"successCount":3,"failureCount":0,"discountId":"1276832317618"}
{"logger":"webhook.discounts.created","ts":"2025-09-14T23:11:16.427Z","message":"Updated product metafields and relationships","updated":3,"attempted":3,"discountId":"1276832317618"}
{"logger":"webhook.discounts.created","ts":"2025-09-14T23:11:16.428Z","message":"Processed discount created","id":"1276832317618","title":"20per","type":"automatic","status":"ACTIVE","code":"N/A (Automatic)","value":"20%","deleted":false,"shop":"discount-metafield-remix-akash-test.myshopify.com"}
{"logger":"webhook.products.updated","ts":"2025-09-14T23:11:16.544Z","message":"Received product webhook","topic":"PRODUCTS_UPDATE","shop":"discount-metafield-remix-akash-test.myshopify.com"}
{"logger":"webhook.products.updated","ts":"2025-09-14T23:11:16.544Z","message":"Processing product update webhook","productId":8579006628018,"shopifyId":"8579006628018","title":"The Collection Snowboard: Oxygen"}
{"logger":"webhook.products.updated","ts":"2025-09-14T23:11:17.025Z","message":"Synced product from Shopify","shopifyId":"8579006628018","saved":true}
{"logger":"webhook.products.updated","ts":"2025-09-14T23:11:17.028Z","message":"Product updated and synced successfully","shopifyId":"8579006628018","title":"The Collection Snowboard: Oxygen","shop":"discount-metafield-remix-akash-test.myshopify.com"}
{"logger":"webhook.products.updated","ts":"2025-09-14T23:11:17.028Z","message":"Processed product updated","id":13,"title":"The Collection Snowboard: Oxygen","shopifyId":"8579006628018","deleted":false,"shop":"discount-metafield-remix-akash-test.myshopify.com"}
{"logger":"webhook.discounts.created","ts":"2025-09-14T23:11:17.605Z","message":"Received webhook","topic":"DISCOUNTS_CREATE","shop":"discount-metafield-remix-akash-test.myshopify.com"}
{"logger":"webhook.products.updated","ts":"2025-09-14T23:11:17.774Z","message":"Received product webhook","topic":"PRODUCTS_UPDATE","shop":"discount-metafield-remix-akash-test.myshopify.com"}
{"logger":"webhook.products.updated","ts":"2025-09-14T23:11:17.774Z","message":"Processing product update webhook","productId":8579006464178,"shopifyId":"8579006464178","title":"The Collection Snowboard: Hydrogen"}
{"logger":"webhook.discounts.created","ts":"2025-09-14T23:11:18.108Z","message":"Updated existing metafield rule","discountId":"1276832317618"}
{"logger":"webhook.products.updated","ts":"2025-09-14T23:11:18.272Z","message":"Synced product from Shopify","shopifyId":"8579006464178","saved":true}
{"logger":"webhook.products.updated","ts":"2025-09-14T23:11:18.275Z","message":"Product updated and synced successfully","shopifyId":"8579006464178","title":"The Collection Snowboard: Hydrogen","shop":"discount-metafield-remix-akash-test.myshopify.com"}
{"logger":"webhook.products.updated","ts":"2025-09-14T23:11:18.275Z","message":"Processed product updated","id":8,"title":"The Collection Snowboard: Hydrogen","shopifyId":"8579006464178","deleted":false,"shop":"discount-metafield-remix-akash-test.myshopify.com"}
{"logger":"webhook.discounts.created","ts":"2025-09-14T23:11:18.552Z","message":"Found discount node","discountId":"gid://shopify/DiscountAutomaticNode/1276832317618","typename":"DiscountAutomaticBasic","title":"20per","status":"ACTIVE"}
{"logger":"webhook.discounts.created","ts":"2025-09-14T23:11:18.552Z","message":"Parsed discount targeting","discountId":"gid://shopify/DiscountAutomaticNode/1276832317618","appliesToAll":false,"productCount":0,"collectionCount":1}
{"logger":"webhook.discounts.created","ts":"2025-09-14T23:11:18.984Z","message":"Fetched products from collections","collectionCount":1,"productCount":3}
{"logger":"webhook.discounts.created","ts":"2025-09-14T23:11:18.984Z","message":"Found affected products","discountGraphqlId":"gid://shopify/DiscountAutomaticNode/1276832317618","count":3}
{"logger":"webhook.discounts.created","ts":"2025-09-14T23:11:19.933Z","message":"Updated product metafield","productId":"gid://shopify/Product/8579006759090","discountId":"1276832317618","discountCount":3}
{"logger":"webhook.discounts.created","ts":"2025-09-14T23:11:21.348Z","message":"Updated product metafield","productId":"gid://shopify/Product/8579006628018","discountId":"1276832317618","discountCount":3}
{"logger":"webhook.discounts.created","ts":"2025-09-14T23:11:22.803Z","message":"Updated product metafield","productId":"gid://shopify/Product/8579006464178","discountId":"1276832317618","discountCount":3}
{"logger":"webhook.discounts.created","ts":"2025-09-14T23:11:23.304Z","message":"Bulk metafield update completed","totalProcessed":3,"successCount":3,"failureCount":0,"discountId":"1276832317618"}
{"logger":"webhook.discounts.created","ts":"2025-09-14T23:11:23.316Z","message":"Updated product metafields and relationships","updated":3,"attempted":3,"discountId":"1276832317618"}
{"logger":"webhook.discounts.created","ts":"2025-09-14T23:11:23.316Z","message":"Processed discount created","id":"1276832317618","title":"20per","type":"automatic","status":"ACTIVE","code":"N/A (Automatic)","value":"20%","deleted":false,"shop":"discount-metafield-remix-akash-test.myshopify.com"}
{"logger":"webhook.discounts.created","ts":"2025-09-14T23:12:24.326Z","message":"Received webhook","topic":"DISCOUNTS_CREATE","shop":"discount-metafield-remix-akash-test.myshopify.com"}
{"logger":"webhook.discounts.created","ts":"2025-09-14T23:12:24.965Z","message":"Updated existing metafield rule","discountId":"1276832317618"}
{"logger":"webhook.discounts.created","ts":"2025-09-14T23:12:25.463Z","message":"Found discount node","discountId":"gid://shopify/DiscountAutomaticNode/1276832317618","typename":"DiscountAutomaticBasic","title":"20per","status":"ACTIVE"}
{"logger":"webhook.discounts.created","ts":"2025-09-14T23:12:25.463Z","message":"Parsed discount targeting","discountId":"gid://shopify/DiscountAutomaticNode/1276832317618","appliesToAll":false,"productCount":0,"collectionCount":1}
{"logger":"webhook.discounts.created","ts":"2025-09-14T23:12:26.626Z","message":"Fetched products from collections","collectionCount":1,"productCount":3}
{"logger":"webhook.discounts.created","ts":"2025-09-14T23:12:26.626Z","message":"Found affected products","discountGraphqlId":"gid://shopify/DiscountAutomaticNode/1276832317618","count":3}
{"logger":"webhook.discounts.created","ts":"2025-09-14T23:12:27.847Z","message":"Updated product metafield","productId":"gid://shopify/Product/8579006759090","discountId":"1276832317618","discountCount":3}
{"logger":"webhook.discounts.created","ts":"2025-09-14T23:12:29.301Z","message":"Updated product metafield","productId":"gid://shopify/Product/8579006628018","discountId":"1276832317618","discountCount":3}
{"logger":"webhook.discounts.created","ts":"2025-09-14T23:12:30.754Z","message":"Updated product metafield","productId":"gid://shopify/Product/8579006464178","discountId":"1276832317618","discountCount":3}
{"logger":"webhook.discounts.created","ts":"2025-09-14T23:12:31.254Z","message":"Bulk metafield update completed","totalProcessed":3,"successCount":3,"failureCount":0,"discountId":"1276832317618"}
{"logger":"webhook.discounts.created","ts":"2025-09-14T23:12:31.269Z","message":"Updated product metafields and relationships","updated":3,"attempted":3,"discountId":"1276832317618"}
{"logger":"webhook.discounts.created","ts":"2025-09-14T23:12:31.269Z","message":"Processed discount created","id":"1276832317618","title":"20per","type":"automatic","status":"ACTIVE","code":"N/A (Automatic)","value":"20%","deleted":false,"shop":"discount-metafield-remix-akash-test.myshopify.com"}
{"logger":"webhook.discounts.created","ts":"2025-09-14T23:14:30.626Z","message":"Received webhook","topic":"DISCOUNTS_CREATE","shop":"discount-metafield-remix-akash-test.myshopify.com"}
{"logger":"webhook.discounts.created","ts":"2025-09-14T23:14:31.286Z","message":"Created metafield rule","discountId":"1276832317618"}
{"logger":"discounts-action","ts":"2025-09-14T23:14:31.535Z","message":"Starting discount initialization..."}
{"logger":"discounts-action","ts":"2025-09-14T23:14:31.535Z","message":"Starting initialization of all existing discounts"}
{"logger":"webhook.discounts.created","ts":"2025-09-14T23:14:31.788Z","message":"Found discount node","discountId":"gid://shopify/DiscountAutomaticNode/1276832317618","typename":"DiscountAutomaticBasic","title":"20per","status":"ACTIVE"}
{"logger":"webhook.discounts.created","ts":"2025-09-14T23:14:31.788Z","message":"Parsed discount targeting","discountId":"gid://shopify/DiscountAutomaticNode/1276832317618","appliesToAll":false,"productCount":0,"collectionCount":1}
{"logger":"discounts-action","ts":"2025-09-14T23:14:32.136Z","message":"Found 3 discounts in Shopify"}
{"logger":"discounts-action","ts":"2025-09-14T23:14:32.142Z","message":"Initialization completed","totalFound":3,"processed":0,"skipped":3,"errors":0}
{"logger":"discounts-action","ts":"2025-09-14T23:14:32.142Z","message":"Initialization completed","success":true,"totalFound":3,"processed":0,"skipped":3,"errors":0}
{"logger":"webhook.discounts.created","ts":"2025-09-14T23:14:32.244Z","message":"Fetched products from collections","collectionCount":1,"productCount":3}
{"logger":"webhook.discounts.created","ts":"2025-09-14T23:14:32.244Z","message":"Found affected products","discountGraphqlId":"gid://shopify/DiscountAutomaticNode/1276832317618","count":3}
{"logger":"webhook.discounts.created","ts":"2025-09-14T23:14:33.257Z","message":"Updated product metafield","productId":"gid://shopify/Product/8579006759090","discountId":"1276832317618","discountCount":3}
{"logger":"webhook.discounts.created","ts":"2025-09-14T23:14:34.710Z","message":"Updated product metafield","productId":"gid://shopify/Product/8579006628018","discountId":"1276832317618","discountCount":3}
{"logger":"webhook.discounts.created","ts":"2025-09-14T23:14:36.090Z","message":"Updated product metafield","productId":"gid://shopify/Product/8579006464178","discountId":"1276832317618","discountCount":3}
{"logger":"webhook.discounts.created","ts":"2025-09-14T23:14:36.591Z","message":"Bulk metafield update completed","totalProcessed":3,"successCount":3,"failureCount":0,"discountId":"1276832317618"}
{"logger":"webhook.discounts.created","ts":"2025-09-14T23:14:36.605Z","message":"Creating bulk product-discount relationships","count":3,"shop":"discount-metafield-remix-akash-test.myshopify.com"}
{"logger":"webhook.discounts.created","ts":"2025-09-14T23:14:36.624Z","message":"Bulk created product-discount relationships","count":3,"shop":"discount-metafield-remix-akash-test.myshopify.com"}
{"logger":"webhook.discounts.created","ts":"2025-09-14T23:14:36.628Z","message":"Bulk relationship creation completed","created":3,"updated":0,"skipped":0,"errors":0}
{"logger":"webhook.discounts.created","ts":"2025-09-14T23:14:36.628Z","message":"Created new ProductDiscount relationships","discountId":"1276832317618","discountRuleId":5,"created":3,"updated":0,"skipped":0,"errors":0}
{"logger":"webhook.discounts.created","ts":"2025-09-14T23:14:36.628Z","message":"Updated product metafields and relationships","updated":3,"attempted":3,"discountId":"1276832317618"}
{"logger":"webhook.discounts.created","ts":"2025-09-14T23:14:36.628Z","message":"Processed discount created","id":"1276832317618","title":"20per","type":"automatic","status":"ACTIVE","code":"N/A (Automatic)","value":"20%","deleted":false,"shop":"discount-metafield-remix-akash-test.myshopify.com"}
